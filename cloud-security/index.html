
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="cloudsec compediums">
      
      
      
        <link rel="canonical" href="https://notes.aldosimon.com/cloud-security/">
      
      
        <link rel="prev" href="../best-practice-to-allow-3p-to-access-aws-accounts/">
      
      
        <link rel="next" href="../cloud-threat-hunt/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>Cloud Security - GitGud Security Notes</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cloud-security" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="GitGud Security Notes" class="md-header__button md-logo" aria-label="GitGud Security Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GitGud Security Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Cloud Security
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="GitGud Security Notes" class="md-nav__button md-logo" aria-label="GitGud Security Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    GitGud Security Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../amazon-vpc-log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Amazon VPC Log
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../application-security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Application Security
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-detect-and-response/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS Detection and Response
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-detection-catalogue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS Detection Catalogue
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-iam-quick-check/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS IAM Quick Check
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-protect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS Protect
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-respond/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS Respond
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-security-tips/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS Security Tips
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../best-practice-to-allow-3p-to-access-aws-accounts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Allow 3P/SaaS to access AWS accounts
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Cloud Security
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Cloud Security
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cloud-security-program" class="md-nav__link">
    <span class="md-ellipsis">
      cloud security program
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cloud security program">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cloudsec-orienteering" class="md-nav__link">
    <span class="md-ellipsis">
      cloudsec orienteering
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cloudsec orienteering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-principles" class="md-nav__link">
    <span class="md-ellipsis">
      core principles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corporate-archaeology" class="md-nav__link">
    <span class="md-ellipsis">
      corporate archaeology
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prioritization" class="md-nav__link">
    <span class="md-ellipsis">
      prioritization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="prioritization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#identity-perimeter" class="md-nav__link">
    <span class="md-ellipsis">
      identity perimeter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-perimeter" class="md-nav__link">
    <span class="md-ellipsis">
      network perimeter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hosted-application" class="md-nav__link">
    <span class="md-ellipsis">
      hosted application
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#future-planning" class="md-nav__link">
    <span class="md-ellipsis">
      future planning
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10x-cloudsec" class="md-nav__link">
    <span class="md-ellipsis">
      10x-cloudsec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#30-60-90-180d-chris-farris" class="md-nav__link">
    <span class="md-ellipsis">
      30-60-90-180d chris farris
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rami-mac" class="md-nav__link">
    <span class="md-ellipsis">
      rami-mac
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rami-mac">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#30-60-90d" class="md-nav__link">
    <span class="md-ellipsis">
      30-60-90d
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#philosophy" class="md-nav__link">
    <span class="md-ellipsis">
      philosophy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-program" class="md-nav__link">
    <span class="md-ellipsis">
      security-program
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other-categories-of-cloudsec-program" class="md-nav__link">
    <span class="md-ellipsis">
      other categories of cloudsec program
    </span>
  </a>
  
    <nav class="md-nav" aria-label="other categories of cloudsec program">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#invariants" class="md-nav__link">
    <span class="md-ellipsis">
      invariants
    </span>
  </a>
  
    <nav class="md-nav" aria-label="invariants">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aws-policy" class="md-nav__link">
    <span class="md-ellipsis">
      aws-policy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-allowlisting" class="md-nav__link">
    <span class="md-ellipsis">
      service-allowlisting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerability-and-asset-management" class="md-nav__link">
    <span class="md-ellipsis">
      vulnerability-and-asset-management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="vulnerability-and-asset-management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#asset-inventory" class="md-nav__link">
    <span class="md-ellipsis">
      asset-inventory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hygiene" class="md-nav__link">
    <span class="md-ellipsis">
      hygiene
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vuln-management" class="md-nav__link">
    <span class="md-ellipsis">
      vuln-management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cheatsheet" class="md-nav__link">
    <span class="md-ellipsis">
      cheatsheet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iam" class="md-nav__link">
    <span class="md-ellipsis">
      iam
    </span>
  </a>
  
    <nav class="md-nav" aria-label="iam">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#least-privilege" class="md-nav__link">
    <span class="md-ellipsis">
      least-privilege
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#infra-access" class="md-nav__link">
    <span class="md-ellipsis">
      infra-access
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#services-identity" class="md-nav__link">
    <span class="md-ellipsis">
      services-identity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detection" class="md-nav__link">
    <span class="md-ellipsis">
      detection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#state-of-the-cloud" class="md-nav__link">
    <span class="md-ellipsis">
      state-of-the-cloud
    </span>
  </a>
  
    <nav class="md-nav" aria-label="state-of-the-cloud">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#big-picture-of-attack-vector-and-remediation" class="md-nav__link">
    <span class="md-ellipsis">
      big picture of attack vector and remediation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="big picture of attack vector and remediation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#threat-model-based-off-uctm-httpssecurosiscomwp-contentuploads202404uctm_v_10pdf" class="md-nav__link">
    <span class="md-ellipsis">
      threat model based off UCTM https://securosis.com/wp-content/uploads/2024/04/UCTM_v_1.0.pdf
    </span>
  </a>
  
    <nav class="md-nav" aria-label="threat model based off UCTM https://securosis.com/wp-content/uploads/2024/04/UCTM_v_1.0.pdf">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#remediate-with" class="md-nav__link">
    <span class="md-ellipsis">
      remediate with
    </span>
  </a>
  
    <nav class="md-nav" aria-label="remediate with">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lost-stolen-or-exposed-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      Lost, stolen, or exposed credentials
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publicly-exposed-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Publicly exposed resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#credentials-exposed-via-application-security-flaws" class="md-nav__link">
    <span class="md-ellipsis">
      Credentials exposed via application security flaws
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unpatched-vulnerabilities-and-zero-days-in-overly-exposed-systems" class="md-nav__link">
    <span class="md-ellipsis">
      Unpatched vulnerabilities and zero-days in overly exposed systems
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#denial-of-service-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Denial of Service attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supply-chain-compromise" class="md-nav__link">
    <span class="md-ellipsis">
      Supply chain compromise
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cloud-detection-catalogue" class="md-nav__link">
    <span class="md-ellipsis">
      cloud-detection-catalogue
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#detection-response" class="md-nav__link">
    <span class="md-ellipsis">
      detection-response
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#protect" class="md-nav__link">
    <span class="md-ellipsis">
      protect
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references-and-related" class="md-nav__link">
    <span class="md-ellipsis">
      references-and-related
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud-threat-hunt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloud Threat Hunt
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloudfront%20log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CloudFront log
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloudtrail/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CloudTrail
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloudwatch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CloudWatch
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../detection-engineering-data-source/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Detection Engineering Data Source
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../detection-engineering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Detection Engineering
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ec2-logs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EC2 Logs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../guardduty/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GuardDuty
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../infosec-compendiums/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Infosec Compendiums
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lambda-log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lambda log
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../maturity-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maturity Model
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../microsoft-defender-suite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Microsoft Defender Suite
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../microsoft-entra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Microsoft Entra
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../rds-log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RDS log
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../threat-modelling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Threat Modelling
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../vulnerability-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vulnerability Management
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cloud-security-program" class="md-nav__link">
    <span class="md-ellipsis">
      cloud security program
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cloud security program">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cloudsec-orienteering" class="md-nav__link">
    <span class="md-ellipsis">
      cloudsec orienteering
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cloudsec orienteering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-principles" class="md-nav__link">
    <span class="md-ellipsis">
      core principles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corporate-archaeology" class="md-nav__link">
    <span class="md-ellipsis">
      corporate archaeology
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prioritization" class="md-nav__link">
    <span class="md-ellipsis">
      prioritization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="prioritization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#identity-perimeter" class="md-nav__link">
    <span class="md-ellipsis">
      identity perimeter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-perimeter" class="md-nav__link">
    <span class="md-ellipsis">
      network perimeter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hosted-application" class="md-nav__link">
    <span class="md-ellipsis">
      hosted application
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#future-planning" class="md-nav__link">
    <span class="md-ellipsis">
      future planning
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10x-cloudsec" class="md-nav__link">
    <span class="md-ellipsis">
      10x-cloudsec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#30-60-90-180d-chris-farris" class="md-nav__link">
    <span class="md-ellipsis">
      30-60-90-180d chris farris
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rami-mac" class="md-nav__link">
    <span class="md-ellipsis">
      rami-mac
    </span>
  </a>
  
    <nav class="md-nav" aria-label="rami-mac">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#30-60-90d" class="md-nav__link">
    <span class="md-ellipsis">
      30-60-90d
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#philosophy" class="md-nav__link">
    <span class="md-ellipsis">
      philosophy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-program" class="md-nav__link">
    <span class="md-ellipsis">
      security-program
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other-categories-of-cloudsec-program" class="md-nav__link">
    <span class="md-ellipsis">
      other categories of cloudsec program
    </span>
  </a>
  
    <nav class="md-nav" aria-label="other categories of cloudsec program">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#invariants" class="md-nav__link">
    <span class="md-ellipsis">
      invariants
    </span>
  </a>
  
    <nav class="md-nav" aria-label="invariants">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aws-policy" class="md-nav__link">
    <span class="md-ellipsis">
      aws-policy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-allowlisting" class="md-nav__link">
    <span class="md-ellipsis">
      service-allowlisting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerability-and-asset-management" class="md-nav__link">
    <span class="md-ellipsis">
      vulnerability-and-asset-management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="vulnerability-and-asset-management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#asset-inventory" class="md-nav__link">
    <span class="md-ellipsis">
      asset-inventory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hygiene" class="md-nav__link">
    <span class="md-ellipsis">
      hygiene
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vuln-management" class="md-nav__link">
    <span class="md-ellipsis">
      vuln-management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cheatsheet" class="md-nav__link">
    <span class="md-ellipsis">
      cheatsheet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iam" class="md-nav__link">
    <span class="md-ellipsis">
      iam
    </span>
  </a>
  
    <nav class="md-nav" aria-label="iam">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#least-privilege" class="md-nav__link">
    <span class="md-ellipsis">
      least-privilege
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#infra-access" class="md-nav__link">
    <span class="md-ellipsis">
      infra-access
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#services-identity" class="md-nav__link">
    <span class="md-ellipsis">
      services-identity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detection" class="md-nav__link">
    <span class="md-ellipsis">
      detection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#state-of-the-cloud" class="md-nav__link">
    <span class="md-ellipsis">
      state-of-the-cloud
    </span>
  </a>
  
    <nav class="md-nav" aria-label="state-of-the-cloud">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#big-picture-of-attack-vector-and-remediation" class="md-nav__link">
    <span class="md-ellipsis">
      big picture of attack vector and remediation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="big picture of attack vector and remediation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#threat-model-based-off-uctm-httpssecurosiscomwp-contentuploads202404uctm_v_10pdf" class="md-nav__link">
    <span class="md-ellipsis">
      threat model based off UCTM https://securosis.com/wp-content/uploads/2024/04/UCTM_v_1.0.pdf
    </span>
  </a>
  
    <nav class="md-nav" aria-label="threat model based off UCTM https://securosis.com/wp-content/uploads/2024/04/UCTM_v_1.0.pdf">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#remediate-with" class="md-nav__link">
    <span class="md-ellipsis">
      remediate with
    </span>
  </a>
  
    <nav class="md-nav" aria-label="remediate with">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lost-stolen-or-exposed-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      Lost, stolen, or exposed credentials
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publicly-exposed-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Publicly exposed resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#credentials-exposed-via-application-security-flaws" class="md-nav__link">
    <span class="md-ellipsis">
      Credentials exposed via application security flaws
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unpatched-vulnerabilities-and-zero-days-in-overly-exposed-systems" class="md-nav__link">
    <span class="md-ellipsis">
      Unpatched vulnerabilities and zero-days in overly exposed systems
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#denial-of-service-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Denial of Service attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supply-chain-compromise" class="md-nav__link">
    <span class="md-ellipsis">
      Supply chain compromise
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cloud-detection-catalogue" class="md-nav__link">
    <span class="md-ellipsis">
      cloud-detection-catalogue
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#detection-response" class="md-nav__link">
    <span class="md-ellipsis">
      detection-response
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#protect" class="md-nav__link">
    <span class="md-ellipsis">
      protect
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references-and-related" class="md-nav__link">
    <span class="md-ellipsis">
      references-and-related
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="cloud-security">Cloud Security</h1>
<h2 id="cloud-security-program">cloud security program</h2>
<p>This section talks about building, maintaining, upgrading your cloudsec program.</p>
<h3 id="cloudsec-orienteering">cloudsec orienteering</h3>
<p>based off rami mac <a href="https://tldrsec.com/p/blog-cloud-security-orienteering">cloud security orienteering</a></p>
<p>this is not a full cloud security program but more on how to orientate in a cloud environment, dig in to identify the risks that matter, and put together actionable plans that address short, medium, and long term goals.</p>
<h4 id="core-principles">core principles</h4>
<p>these are principles you use when doing orienteering, keep these in mind.</p>
<ul>
<li>breadth, then depth: do not go too deep, instead go wide and understand all the context;</li>
<li>anomaly detection: you are basically trying to find anomaly, things out of ordinary, out of norm;</li>
<li>inside out and outside in: do it from the inside -&gt; maximum read access, but also try to do it/ emulate attackers perspective;</li>
</ul>
<h4 id="corporate-archaeology">corporate archaeology</h4>
<p>the goal is to understand your estate:</p>
<ol>
<li>Architecture diagrams or documentation of intended workloads.</li>
<li>Definition of "crown jewels", the unique set of data that is identified by the business as the most sensitive if compromised. </li>
<li>Intended authentication and identity approach.</li>
</ol>
<p>these are ideas on how you would find information asset:</p>
<ul>
<li>Identify and review any existing asset inventory</li>
<li>review IaC (terraform, ansible, puppet, cloudformation)</li>
<li>Review any data classification and designation of scope for those classes of data</li>
<li>Review organizational documentation: Wikis, Documents</li>
<li>Identify any existing cloud security tools or vendors in use</li>
</ul>
<p>the steps are to find environments (accounts/ orgs) -&gt; workloads (e.g. project x; ecommerce x) -&gt; services (EC2, S3) -&gt; resources (individual resources)</p>
<ul>
<li>[ ] expand on this</li>
</ul>
<p>ideas on findings environments (accounts) from <a href="https://summitroute.com/blog/2018/06/18/how_to_inventory_aws_accounts/">summitroute</a></p>
<h4 id="prioritization">prioritization</h4>
<p>The next step to distill all the information you’ve gathered in actionable guidance, focused on what is <strong>most immediately important</strong>.</p>
<h5 id="identity-perimeter">identity perimeter</h5>
<ol>
<li>management plane access model: you should have information how management plane access happens, and understand risk of them. in the future aim for single, auditable mechanism e.g. AWS SSO with your IdP (with phish resistant tech.)
   Remove insecure mechanism such as Access Key/Secret Key, any use of IAM Users directly, unused users and roles, and ensure secure configurations are used for cross-account access for humans (MFA) and services (ExternalID).</li>
<li>server access model: understand what are currently use and the risk, mitigate/remediate and try to aim for best practice in the long run. SSH w/ key (no password!) &gt; bastion/ jump host &gt; AWS SSM.
   in short term, get compensating control fail2ban, bastion but aim for the ideal cloud native offering(SSM)</li>
<li>IAM Security: do not use/secure root; clean up unused roles -&gt; see access analyzer result; use IAM roles instead of users; understand risk of cross-account trust;<ul>
<li><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_getting-report.html">IAM Credential Report</a>: Identify unused users and roles, and well as authentication patterns, such as MFA usage.</li>
<li><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html">IAM Access Analyzer</a>: Identify resources in your accounts shared with external entities.</li>
<li><a href="https://aws.amazon.com/premiumsupport/technology/trusted-advisor/best-practice-checklist/">Trusted Advisor</a> (free): Multi-factor authentication on root account, AWS IAM use.</li>
<li><a href="https://aws.amazon.com/config/">AWS Config</a> and/or <a href="https://aws.amazon.com/security-hub/">Security Hub</a>, if in use.</li>
</ul>
</li>
</ol>
<h5 id="network-perimeter">network perimeter</h5>
<ol>
<li>Public resources in managed services: understand resources that allow to be public thorugh RCP, sharing API, network access. <a href="https://github.com/SummitRoute/aws_exposable_resources">read more</a></li>
<li>Public network access to hosted services: leverage findings from tooling or trusted advisor, security groups that are open etc.</li>
<li><strong>Default, insecure resources</strong></li>
</ol>
<h5 id="hosted-application">hosted application</h5>
<ul>
<li>Out of date services, especially ones with known vulnerabilities.  </li>
<li>Unauthenticated services that are unintentionally exposed.</li>
<li>Sensitive or internal services that are needlessly public, such as CI/CD tools.</li>
</ul>
<p>understand the risk vs ticking box, example: <a href="https://www.chrisfarris.com/post/cloud-encryption/?utm_source=tldrsec.com&amp;utm_medium=referral&amp;utm_campaign=cloud-security-orienteering">here</a></p>
<h4 id="future-planning">future planning</h4>
<p>To start, consider a blanket set of (fairly) universally applicable AWS hardening recommendations, including</p>
<ul>
<li>Enable GuardDuty in all accounts, and centralize alerts.</li>
<li>Enable Cloudtrail in all accounts; turn on optional security features, including encryption at-rest and file validation; centralize and back up logs. </li>
<li>Ensure security visibility and break-glass access to all accounts.</li>
<li>Configure account-wide security defaults, including S3 block public access, EBS and all other default encryption.</li>
</ul>
<p>use maturity framework to have a map
<a href="https://www.iansresearch.com/resources/cloud-security-maturity-model/what-is-the-csmm?utm_source=tldrsec.com&amp;utm_medium=referral&amp;utm_campaign=cloud-security-orienteering">CSMM</a>
<a href="https://roadmap.cloudsecdocs.com/?utm_source=tldrsec.com&amp;utm_medium=referral&amp;utm_campaign=cloud-security-orienteering">marco lancini cloudsec map</a></p>
<h3 id="10x-cloudsec">10x-cloudsec</h3>
<p><a href="https://www.youtube.com/@fwdcloudsec">How to 10X Your Cloud Security (Without the Series D) ~ Rami McCarthy</a></p>
<h3 id="30-60-90-180d-chris-farris">30-60-90-180d chris farris</h3>
<p>this is from <a href="https://www.chrisfarris.com/post/ghost-of-cloudsec-yet-to-come/">ghost of cloudsec yet to come</a></p>
<p>The 30-day plan is about ensuring the <strong>basics</strong> are in place. </p>
<ol>
<li>Is <strong>CloudTrail</strong> enabled and feeding the SEIM?</li>
<li>Are there dedicated <strong>security &amp; logging accounts</strong>?</li>
<li>Does the security account have <strong>audit capability</strong> to the environment?</li>
<li>Do you have <strong>GuardDuty</strong> enabled?</li>
<li>Do you know all of the accounts you have and who is accountable for them? What is the multi-account strategy?</li>
<li>Are cloud users leveraging federated <strong>identities or IAM Users</strong>?</li>
<li>Is there a security baseline for cloud usage? What security policies, standards, and baselines do exist?</li>
<li>Who are the core cloud constituencies? How do they see the current security team? Who will be allies, and who do you need to influence?</li>
</ol>
<p>The 60-day plan would focus on <strong>situational awareness</strong> and <strong>introducing the cloud security program</strong> to the company’s broader cloud user community.</p>
<ol>
<li>Deploy a CSPM solution. Probably something free.</li>
<li>Deploy IAM Access Analyzer</li>
<li>Review the CSPM and access analyzer results for the most egregious issues and target them as part of the initial outreach. By egregious issues, I’m referring to 3389 open to the world on a windows box or unauthenticated elastic search clusters. Encryption, public buckets, etc., are not on this list.</li>
<li>Deploy an auto-remediation tool like Cloud Custodian, but do it in notify-only mode. Hold the findings internally for a risk-based targeted outreach.</li>
<li>If you’re ambitious, price out and consider using Macie to scan the public buckets for PII.</li>
<li>Start creating your KRIs. <em>Don’t share them with anyone just yet.</em> Understand how your KRI automation reflects the risk to the business and adjust accordingly.</li>
<li>Leverage the CSPM and auto-remediation tools findings to advise how to proceed.
For the last point - which teams or accounts have the most findings? Is there a pattern of opening security groups because there is no architectural pattern for secure on-prem or on-network connectivity? If so, fix that.</li>
</ol>
<p>Begin the user education phase of things -&gt; democratizing security. also see <a href="#rami-mac">rami</a></p>
<ol>
<li>Write a security baseline or security best practices document for the development community. Be careful here. If this document becomes part of the formal GRC/Policy framework, you’ve fallen into the Tar-Pit of CSPM, and you’ve become part of the compliance police. The goal is a secure environment, so focus on developer education.</li>
<li>Introduce a core set of SCPs to cover the security invariants that the security and cloud user community can agree on. Develop a mutual understanding of how exceptions might be handled.</li>
<li>Work with teams to get the CloudCustodian notifications delivered to the teams themselves, rather than just the security team. Still, in notify-only mode, they now start to see in real-time the new issues being created. This avoids swamping them with eight years of un-encrypted snapshots and databases and demoralizing them with thousands of findings.</li>
<li>Start building out the IaC scanning according to your company’s risk profile.</li>
</ol>
<p>Now you’re ready to enable the full suite of preventative controls
1. Ensure the developers are using IaC scanning. They know what is coming via the auto-remediation and Service Control Policies. They know their deployments will fail if certain things are not resolved.
2. Enable the next level of SCPs to prevent things at the IAM phase. This will cause pipelines to break and throw weird errors at users doing ClickOps.
3. Enable the auto-remediation capability in Cloud Custodian (first in dev accounts, then in prod). IaC scanning should prevent these policies from firing in automated accounts, so this is a way to catch errors via ClickOps or pipeline operators who ignore the warnings. Remember: actual remediation must be against high security-risk misconfigurations, where the remediation is low operational risk.
4. Start monitoring your KRIs. Do you see a drop-off in the older CSPM findings? If yes, great, keep things moving along.
5. If your KRIs indicate a certain class of risk is not going down, consider a targeted effort to resolve those.
6. If you deploy a CSPM vulnerability management program with SLAs, ensure that high-effort-to-remediate findings aren’t just added to a spreadsheet. They must be part of a risk-informed architectural review.</p>
<h3 id="rami-mac">rami-mac</h3>
<p>this is from his podcast talk on <a href="https://www.youtube.com/watch?v=pOUfXgRVsF8&amp;pp=ygUNUmFtaSBNY0NhcnRoeQ%3D%3D">O3 cyber podcast</a></p>
<pre class="mermaid"><code>mindmap
    root(program)
        visibility
            horizontal: asset, csp, stack?
            vertical: prioritize on key risk, not too deep
        posture
            asses critical risk
        defense
            monitoring, IR plan, log scaling
        democratizing security
            guardrail vs gatekeep
            empower developer </code></pre>
<ul>
<li><strong>Visibility First:</strong> Ramy emphasizes the importance of visibility in security, focusing on both organizational and technical aspects.  <ul>
<li>He suggests a 30-60-90 day plan for new roles, prioritizing understanding relationships and business context. The visibility should be horizontal and vertical (altitude)</li>
<li>horizontal example: what asset? what CSP we use? what tech stack?</li>
<li>vertical example: since this is a strategy, we still need a bit of a height, so the vertical should not be too deep on everything, but prioritize on key risk.</li>
<li>A way of prioritizing is using <strong>Three Perimeters Model:</strong> rami introduces a model focusing on identity, network, and application perimeters in the cloud. <ul>
<li><strong>Identity Perimeter:</strong> Cloud management plane, infrastructure access, and third-party identities. </li>
<li><strong>Network Perimeter:</strong> Public resources and managed services (s3 buckets), public network access and hosted services (i.e. public IP) and exposure management. </li>
<li><strong>Application Perimeter:</strong> Vulnerability management and insecure platforms. </li>
</ul>
</li>
</ul>
</li>
<li><strong>Visibility, Posture, and Defense:</strong> Follow a cycle that starts with visibility, moves to assessing critical risks (posture), and then focuses on monitoring, detection, and response (defense). </li>
<li><strong>Business Context:</strong> Understand the business context and strategy to make security relevant and gain support. </li>
<li><strong>Strategy Post 90 Days:</strong> Ramy suggests that a cloud security strategy should provide a consistent model to discuss progress. He recommends using maturity models or frameworks, like the Cyber Defense Matrix, to benchmark and track progress. </li>
<li><strong>The Next Big Thing:</strong> Ramy believes the focus should be on making the basics easier and more achievable, particularly in identity security. He highlights AI's role in driving awareness of existing gaps, especially in data security. </li>
<li><strong>Democratized Security:</strong> Ramy advocates for empowering local experts with shared context, emphasizing the shift towards developers owning their code and the need for security tools to facilitate collaboration. </li>
</ul>
<h4 id="30-60-90d">30-60-90d</h4>
<p>30d: <strong>assess</strong> •Assess •Build relationships •Establish baseline
60d: <strong>better</strong> •Do one thing better •Nail it •Add invariants for your baseline
90d: <strong>scale and ROI</strong> •Plan for scale •Reproducible process •Security ROI •Kill a class of risk</p>
<p>scaling -&gt; democratizing security</p>
<h4 id="philosophy">philosophy</h4>
<p>Do things that don’t scale, automate as much as possible to scale
High-signal, low-noise tools and alerting 
     - okay not to catch everything, but when it catch something, it is impactful
Guardrails, not gatekeepers 
Security as partnership. Embed security in development process 
    - try to eventually scale this: automate, guardrail, baseline
Tools devs can build, others can operate 
The limits of desirable security</p>
<h4 id="security-program">security-program</h4>
<p>basically create baseline, meet the baseline, increase baseline -&gt; ratcheting your security to not backslide
metrics: 
    <a href="https://alsmola.medium.com/building-effective-security-okrs-94f249230a39">building metrics</a>
    <a href="http://collingreene.com/product_security_primitives.html">product security primitives</a>
    <a href="https://medium.com/starting-up-security/a-key-performance-indicator-for-infosec-organizations-7f654b7cd256">kpi infosec org</a>
<a href="https://ramimac.me/scorecarding">scorecard</a>
proactive efficiency: 
    “why not ask ourselves how the team would cope if the workload went up another 30%, but bad financial results precluded any team growth? It's actually fun to think about such hypotheticals ahead of the time - and hey, if the ideas sound good, why not try them out today?“ from <a href="https://lcamtuf.blogspot.com/2018/02/getting-product-security-engineering.html">here</a>
evangelism: use this two questions: how'll we get hacked, and why security matters.</p>
<h2 id="other-categories-of-cloudsec-program">other categories of cloudsec program</h2>
<p>These don't fit, will probably moved to best practices</p>
<h3 id="invariants">invariants</h3>
<p>enforce/ alert on things that should <strong>always</strong> or <strong>never</strong> be true. idea is if there is no need for context (these things should always or never), no need for sec team time</p>
<h4 id="aws-policy">aws-policy</h4>
<p>example: aws scp, examples: <a href="https://rami.wiki/scps/">rami scps</a></p>
<p><a href="https://alsmola.medium.com/security-invariants-or-gtfo-d7db2950f95">alex smolen</a>
<a href="https://www.primeharbor.com/blog/security-invariants/">chris farris</a></p>
<h4 id="service-allowlisting">service-allowlisting</h4>
<p>basically do what GCP is by default. that is deny service unless it is in allow list. this also works for regions too (same thing invariants some regions that will <strong>never</strong> be used)</p>
<p>more here: <a href="https://ramimac.me/aws-allowlisting">rami allowlisting</a></p>
<h3 id="vulnerability-and-asset-management">vulnerability-and-asset-management</h3>
<h4 id="asset-inventory">asset-inventory</h4>
<h4 id="hygiene">hygiene</h4>
<p>ownership issue; unused asset --&gt; use financial issue
<a href="ramimac.me/finops">finops</a></p>
<h4 id="vuln-management">vuln-management</h4>
<h4 id="cheatsheet">cheatsheet</h4>
<p>use these to help structure your vulns
<a href="https://www.trendmicro.com/cloudoneconformity/knowledge-base/">cloud conformity</a>
<a href="https://securitylabs.datadoghq.com/cloud-security-atlas/">cloudsec atlas</a></p>
<h3 id="iam">iam</h3>
<h4 id="least-privilege">least-privilege</h4>
<p>do we need absolute least priv. or good enough for human, because the needs changes. try service level least privileges, but maybe yes on least priv on crown jewels </p>
<h4 id="infra-access">infra-access</h4>
<ul>
<li>use ssm to access instances</li>
<li>use proxy/ wireguard</li>
</ul>
<h4 id="services-identity">services-identity</h4>
<ul>
<li>clean up unused services periodically. use steampipe <a href="https://ramimac.me/access-advisor-steampipe">here</a></li>
<li>use imdsv2 for legacy instances</li>
</ul>
<h3 id="detection">detection</h3>
<h2 id="state-of-the-cloud">state-of-the-cloud</h2>
<h3 id="big-picture-of-attack-vector-and-remediation">big picture of attack vector and remediation</h3>
<h4 id="threat-model-based-off-uctm-httpssecurosiscomwp-contentuploads202404uctm_v_10pdf">threat model based off UCTM https://securosis.com/wp-content/uploads/2024/04/UCTM_v_1.0.pdf</h4>
<blockquote>
<p>That is why we call this the Universal Cloud Threat Model. It identifies the commonalities all organizations face equally based on cloud usage — regardless of size, vertical, or nationality. We call these the “90% of attacks experienced by 90% of organizations using the cloud</p>
</blockquote>
<ul>
<li>threat model is "custom" for cloud</li>
<li>basically goes: <strong>vector -&gt; sequence -&gt; objectives</strong></li>
<li>for instance.<ul>
<li>vector<ul>
<li>Lost, stolen, or exposed credentials </li>
<li>Publicly exposed resources </li>
<li>Credentials exposed via application security flaws</li>
</ul>
</li>
<li>sequence<ul>
<li>gain access via creds.</li>
<li>enumerate</li>
<li>start compute, inject mining via ssm</li>
</ul>
</li>
<li>objectives<ul>
<li>financial gain</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="remediate-with">remediate with</h5>
<h6 id="lost-stolen-or-exposed-credentials">Lost, stolen, or exposed credentials</h6>
<ul>
<li>Reduce or eliminate static credentials and tokens for the cloud management plane. Where possible use alternatives like IAM Roles and Azure Managed Identities. Automation is your friend. There are plenty of free and commercial tools to hunt these down. </li>
<li>Scan code for stored credentials in CI/CD pipelines and repositories, even if they are private. </li>
<li>Require MFA for all human access, even when using API keys. </li>
<li>Limit the duration of temporary access credentials so they expire after only a few hours. </li>
<li>Migrate administrators and highly-privileged access to Just in Time access and/or use hardware tokens (e.g., Yubikeys). </li>
<li>Implement a “data perimeter” (this can be difcult in established enterprises, but can be very effective, even if only some basics are implemented).</li>
</ul>
<h6 id="publicly-exposed-resources">Publicly exposed resources</h6>
<ul>
<li>Use your cloud service provider’s built-in assessment tools or a free or third-party scanner to identify public resources.  The key is sufficient coverage and act on results.</li>
<li>Use your cloud provider’s policy tools (guardrails) to prevent the creation of public resources where possible. For example Azure Policy, AWS Service Control Policies, and AWS Block Public Access for S3</li>
<li>Automated remediation if you can't block via guardrails.</li>
</ul>
<h6 id="credentials-exposed-via-application-security-flaws">Credentials exposed via application security flaws</h6>
<ul>
<li>Reduce the exposure of applications to the public Internet. Place compute resources behind load balancer which only allow specific API routes.</li>
<li>Do not give applications highly privileged access policies. IAM policies for applications should explicitly enumerate the resources each application needs to access. </li>
<li>Avoid using AWS policies such as FullAccess and Basic Roles in GCP. Your tools (free or commercial) can help identify these. </li>
<li>Scan code in CI/CD pipelines for static credentials. </li>
<li>Ensure that access to the Instance Metadata Service requires authentication headers and limits the number of network hops permitted. For example require IMDSv2 on AWS. </li>
<li>Use a WAF to mitigate undifferentiated application layer attacks. </li>
<li>If your cloud provider offers credential misuse detection (e.g., session credentials used from someplace where the session didn’t originate), use it. These aren’t perfect and only catch these attacks sometimes, but they can really help. AWS GuardDuty is one option.</li>
<li>While challenging and complex, implementing a data perimeter is one of the best defenses for this. Prioritize this option if you are the target of differentiated attacks.</li>
<li>[ ] research on data perimeter practical🔼 </li>
</ul>
<h6 id="unpatched-vulnerabilities-and-zero-days-in-overly-exposed-systems">Unpatched vulnerabilities and zero-days in overly exposed systems</h6>
<ul>
<li>Minimize the number of systems which are exposed to the entire Internet. But we understand some of these systems are exposed to the Internet for legitimate reason, such as VPN servers and jump boxes, which you cannot always eliminate like the inadvertently exposed public resources mentioned earlier. You should still scan them and know where and how they are configured.<ul>
<li>see your CWPP, or CNAPP, or CSP for this.</li>
</ul>
</li>
<li>For containers consider using a container security platform or your cloud provider's container scanning features. Make sure your tool can identify vulnerabilities in <strong>running containers</strong>, not just <strong>images</strong> in storage — or can identify which containers are running vulnerable images.</li>
<li>Enable your cloud provider’s threat detection service (e.g., GuardDuty), which can help detect cryptomining; it is a common result of this attack vector.</li>
<li>Exposed systems should <strong>never</strong> hold static credentials and should have least-privilege IAM permissions. We know this is hard, but if you are going to stick a target on the Internet, don’t be surprised if someone takes you up on your offer. At least try to minimize the potential damage.</li>
<li>Develop SBOM capabilities to discover and respond to zero-day threats when they arise quickly.</li>
</ul>
<h6 id="denial-of-service-attacks">Denial of Service attacks</h6>
<ul>
<li>Never expose workloads directly to the Internet. Even when they need to be exposed, stick them behind a load balancer, Content Delivery Network (CDN), or similar insulating service.</li>
<li>For critical workloads/applications plan for DoS attacks and use standard precautions, such as a service from your CSP or a third-party vendor (AWS shield advance; Google cloud armour)</li>
</ul>
<h6 id="supply-chain-compromise">Supply chain compromise</h6>
<ul>
<li>use base trusted image, packages from trusted sources</li>
<li>SBOM</li>
<li>use Software Composition Analysis SCA</li>
</ul>
<hr />
<h2 id="cloud-detection-catalogue">cloud-detection-catalogue</h2>
<p><a href="../aws-detection-catalogue/">aws-detection-catalogue</a></p>
<hr />
<h2 id="detection-response">detection-response</h2>
<p><a href="aws-detect.md">aws-detect</a></p>
<hr />
<h2 id="protect">protect</h2>
<p><a href="../aws-protect/">aws-protect</a></p>
<hr />
<h2 id="references-and-related">references-and-related</h2>
<p><a href="https://ramimac.me">ramimac</a>
<a href="https://www.youtube.com/watch?v=DgWLWtFbO_o">10x your cloud</a>
<a href="https://ramimac.me/access-advisor-steampipe">steampipe ramimac</a></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../best-practice-to-allow-3p-to-access-aws-accounts/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Allow 3P/SaaS to access AWS accounts">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Allow 3P/SaaS to access AWS accounts
              </div>
            </div>
          </a>
        
        
          
          <a href="../cloud-threat-hunt/" class="md-footer__link md-footer__link--next" aria-label="Next: Cloud Threat Hunt">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Cloud Threat Hunt
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
      
    
    
    
    <a href="https://infosec.exchange/@aldosimon" target="_blank" rel="noopener me" title="ewaldo simon hiras on mastodon" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M433 179.1c0-97.2-63.7-125.7-63.7-125.7-62.5-28.7-228.6-28.4-290.5 0 0 0-63.7 28.5-63.7 125.7 0 115.7-6.6 259.4 105.6 289.1 40.5 10.7 75.3 13 103.3 11.4 50.8-2.8 79.3-18.1 79.3-18.1l-1.7-36.9s-36.3 11.4-77.1 10.1c-40.4-1.4-83-4.4-89.6-54-.6-4.6-.9-9.3-.9-13.9 85.6 20.9 158.7 9.1 178.7 6.7 56.1-6.7 105-41.3 111.2-72.9 9.8-49.8 9-121.5 9-121.5zm-75.1 125.2h-46.6V190.1c0-49.7-64-51.6-64 6.9v62.5H201V197c0-58.5-64-56.6-64-6.9v114.2H90.3c0-122.1-5.2-147.9 18.4-175 25.9-28.9 79.8-30.8 103.8 6.1l11.6 19.5 11.6-19.5c24.1-37.1 78.1-34.8 103.8-6.1 23.7 27.3 18.4 53 18.4 175"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.twitter.com/aldosimon" target="_blank" rel="noopener" title="ewaldo simon hiras on twitter" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
    <a href="https://linkedin.com/in/aldosimon" target="_blank" rel="noopener" title="ewaldo simon hiras on linkedin" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://aldosimon.com" target="_blank" rel="noopener" title="ewaldo simon hiras&#39;s blog" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M35.7 171.1c-46.9 46-46.9 122.9 0 169.8l135.9 135.9c46 46.9 122.9 46.9 169.8 0l135.9-135.9c46.9-46.9 46.9-123.8 0-169.8L341.4 35.2c-46.9-46.9-123.8-46.9-169.8 0zM196 196.5a84.5 84.5 0 1 1 120 119 84.5 84.5 0 1 1-120-119"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/aldosimon" target="_blank" rel="noopener" title="ewaldo simon hiras&#39;s github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.footer"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>