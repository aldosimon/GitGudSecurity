
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://notes.aldosimon.com/aws-respond/">
      
      
        <link rel="prev" href="../aws-protect/">
      
      
        <link rel="next" href="../aws-security-tips/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>AWS Respond - GitGud Security Notes</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#about" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="GitGud Security Notes" class="md-header__button md-logo" aria-label="GitGud Security Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GitGud Security Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              AWS Respond
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="GitGud Security Notes" class="md-nav__button md-logo" aria-label="GitGud Security Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    GitGud Security Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../amazon-vpc-log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Amazon VPC Log
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../application-security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Application Security
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-detect-and-response/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS Detection and Response
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-detection-catalogue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS Detection Catalogue
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-iam-quick-check/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS IAM Quick Check
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-protect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS Protect
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    AWS Respond
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    AWS Respond
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ec2-isolation" class="md-nav__link">
    <span class="md-ellipsis">
      ec2 isolation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ec2 isolation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#containing-an-ec2-using-security-groups" class="md-nav__link">
    <span class="md-ellipsis">
      Containing an EC2 Using Security Groups
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Containing an EC2 Using Security Groups">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#untracked-connections" class="md-nav__link">
    <span class="md-ellipsis">
      Untracked Connections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tracked-connections" class="md-nav__link">
    <span class="md-ellipsis">
      Tracked Connections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isolating-ec2-instances-with-tracked-connections" class="md-nav__link">
    <span class="md-ellipsis">
      Isolating EC2 instances with Tracked Connections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#planning-ahead-with-security-groups" class="md-nav__link">
    <span class="md-ellipsis">
      Planning Ahead With Security Groups
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#containing-an-ec2-using-nacls" class="md-nav__link">
    <span class="md-ellipsis">
      Containing an EC2 Using NACLs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#containing-an-ec2-using-route-tables" class="md-nav__link">
    <span class="md-ellipsis">
      Containing an EC2 Using Route Tables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#containing-ec2-using-internet-gateways" class="md-nav__link">
    <span class="md-ellipsis">
      Containing EC2 Using Internet Gateways
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ec2-containment-playbook" class="md-nav__link">
    <span class="md-ellipsis">
      EC2 Containment Playbook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ec2-contain-with-automation" class="md-nav__link">
    <span class="md-ellipsis">
      EC2 contain with automation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aws-iam" class="md-nav__link">
    <span class="md-ellipsis">
      aws iam
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference-and-related" class="md-nav__link">
    <span class="md-ellipsis">
      reference-and-related
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../aws-security-tips/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS Security Tips
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../best-practice-to-allow-3p-to-access-aws-accounts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Allow 3P/SaaS to access AWS accounts
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud-security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloud Security
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud-threat-hunt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloud Threat Hunt
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloudfront%20log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CloudFront log
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloudtrail/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CloudTrail
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloudwatch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CloudWatch
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../detection-engineering-data-source/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Detection Engineering Data Source
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../detection-engineering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Detection Engineering
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ec2-logs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EC2 Logs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../guardduty/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GuardDuty
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../infosec-compendiums/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Infosec Compendiums
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lambda-log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lambda log
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../maturity-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Maturity Model
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../microsoft-defender-suite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Microsoft Defender Suite
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../microsoft-entra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Microsoft Entra
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../rds-log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RDS log
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../threat-modelling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Threat Modelling
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../vulnerability-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vulnerability Management
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ec2-isolation" class="md-nav__link">
    <span class="md-ellipsis">
      ec2 isolation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ec2 isolation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#containing-an-ec2-using-security-groups" class="md-nav__link">
    <span class="md-ellipsis">
      Containing an EC2 Using Security Groups
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Containing an EC2 Using Security Groups">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#untracked-connections" class="md-nav__link">
    <span class="md-ellipsis">
      Untracked Connections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tracked-connections" class="md-nav__link">
    <span class="md-ellipsis">
      Tracked Connections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isolating-ec2-instances-with-tracked-connections" class="md-nav__link">
    <span class="md-ellipsis">
      Isolating EC2 instances with Tracked Connections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#planning-ahead-with-security-groups" class="md-nav__link">
    <span class="md-ellipsis">
      Planning Ahead With Security Groups
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#containing-an-ec2-using-nacls" class="md-nav__link">
    <span class="md-ellipsis">
      Containing an EC2 Using NACLs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#containing-an-ec2-using-route-tables" class="md-nav__link">
    <span class="md-ellipsis">
      Containing an EC2 Using Route Tables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#containing-ec2-using-internet-gateways" class="md-nav__link">
    <span class="md-ellipsis">
      Containing EC2 Using Internet Gateways
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ec2-containment-playbook" class="md-nav__link">
    <span class="md-ellipsis">
      EC2 Containment Playbook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ec2-contain-with-automation" class="md-nav__link">
    <span class="md-ellipsis">
      EC2 contain with automation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aws-iam" class="md-nav__link">
    <span class="md-ellipsis">
      aws iam
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference-and-related" class="md-nav__link">
    <span class="md-ellipsis">
      reference-and-related
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="about">about</h1>
<p>This page is about respond function in AWS</p>
<h2 id="ec2-isolation">ec2 isolation</h2>
<ul>
<li>[ ] 🔼 need to recheck this
Users can use multiple approaches when isolating an EC2 instance. The approach used will depend on the level of isolation required.</li>
</ul>
<p>The most common methods of isolation are:</p>
<ol>
<li>Security Groups</li>
<li>NACLs</li>
<li>Route Tables</li>
<li>Internet Gateways</li>
</ol>
<h3 id="containing-an-ec2-using-security-groups">Containing an EC2 Using Security Groups</h3>
<p>Security groups are often the most common approach when isolating an EC2 instance due to their ease of use and targeting isolation capabilities.</p>
<p>A security group's default "implicit deny" behaviour makes it a suitable isolation method since a security group without rules will deny all traffic; a security group requires a user to specify rules to allow specific traffic.</p>
<p>However, it is essential to note that adding a security group to an EC2 instance will not restrict traffic, and AWS will grant access to the security group with the most permissive rules.</p>
<p>Therefore to restrict access by using a security group, users must remove all existing security groups from an EC2 instance or remove all the rules from the existing security group.</p>
<p>When using security groups for isolation, it is crucial to consider the connections an EC2 instance may establish via a security group. These types of connections are:</p>
<ol>
<li>Untracked Connections</li>
<li>Tracked Connections</li>
</ol>
<h4 id="untracked-connections">Untracked Connections</h4>
<p><a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-connection-tracking.html">Untracked connections</a> are any connection established from a rule with a "0.0.0.0/0" wildcard. The direction of these connections can be both inbound and outbound.</p>
<p>The significance of these types of connections is that any change to a security group, such as a rule change or security group change, will immediately affect the traffic flow.</p>
<h4 id="tracked-connections">Tracked Connections</h4>
<p><a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-connection-tracking.html">Tracked connections</a> are any connection established from a rule with a specific IP address or segment, such as rules that allow traffic from "43.101.53.202/32". The direction of these connections can be both inbound and outbound.</p>
<p>Unlike untracked connections, changing a rule within a security group or deleting a security group from an EC2 instance will not immediately affect the traffic flow. This property of tracked connections may allow an attacker to maintain established connections even after the specific rules are removed.</p>
<h4 id="isolating-ec2-instances-with-tracked-connections">Isolating EC2 instances with Tracked Connections</h4>
<p>Users must follow the steps mentioned below to isolate an EC2 instance with a tracked connection:</p>
<ol>
<li>Create a dedicated isolation security group without any rules</li>
<li>Create a single rule of 0.0.0.0/0 for all traffic in both the inbound and outbound rules</li>
<li>Remove any existing security groups attached to the EC2 instance</li>
<li>Associate the newly created isolation security group to the instance</li>
<li>Delete both the inbound and outbound rules you created for the isolation security group</li>
</ol>
<p>Following these steps will effectively convert all the existing tracked connections into untracked connections, thus terminating any existing connections.</p>
<h4 id="planning-ahead-with-security-groups">Planning Ahead With Security Groups</h4>
<p>Each second could be the difference between successful isolation or further infection in a time-sensitive operation such as an incident response. Therefore users may keep preconfigured security groups that can be used to perform EC2 isolation.</p>
<p>a. Create a “Step 01” security group with the following rules</p>
<p><img alt="Pasted image 20250330140644" src="../img/Pasted-image-20250330140644.png" /></p>
<p>b. Create a "Step 02" security group without any rules</p>
<p><img alt="Pasted image 20250330140653" src="../img/Pasted-image-20250330140653.png" /></p>
<p>After creating these two security groups, users will now be able to swiftly isolate an EC2 instance while eliminating any tracked connections by using the following steps:</p>
<ol>
<li>Remove all existing security groups or rules within existing security groups</li>
<li>Add the “Step 1” security group to the EC2 instance</li>
<li>Remove the “Step 1” security group from the EC2 instance</li>
<li>Associate the “Step 2” security group to the EC2 instance</li>
</ol>
<h3 id="containing-an-ec2-using-nacls">Containing an EC2 Using NACLs</h3>
<p>NACLs or Network ACLs is the next approach users may use to isolate an EC2 instance. However, NACLs are not targeted; therefore, it is difficult to isolate an individual EC2 instance using an NACL.</p>
<p>A Network ACL relies on rules to allow and deny traffic from subnets; however, unlike security groups, NACLs are stateless, meaning that rules need to be defined for both the request and the response of each connection.</p>
<p>The most significant advantage of using a NACL is that there is no multistage process compared to a security group. A single inbound or outbound rule will deny all traffic towards the respective direction.</p>
<p>However, since NACLs rely on rules based on subnets. Therefore, using NACLs to isolate an EC2 instance will affect all the other instances within the specified subnet.</p>
<p>Users may choose to use an existing NACL for isolation. In this method, users are required to add the deny rule as the first rule of the NACL; if the NACL is full existing rules may need to be removed to make space for the isolation-specific rules at the top of the NACL.</p>
<p>The other approach is to create a new NACL with the deny rules at the start of the NACL and to associate the dedicated isolation NACL to the VPC that hosts the affected EC2 instance.</p>
<h3 id="containing-an-ec2-using-route-tables">Containing an EC2 Using Route Tables</h3>
<p>Users can use route tables to isolate EC2 instances to move up the isolation spectrum. Route tables are an excellent method of isolating EC2 instances from all external networks, such as Internet Gateways, Direct Connections and VPN connections.</p>
<p>However, it is essential to understand that the route table is associated with the VPC that hosts the EC2 instance and not the EC2 instance itself. Therefore even though using a route table for isolation terminates all connections to all external networks, it will also disrupt any connection flowing through the specific VPC.</p>
<p>Additionally, isolating EC2 instances using route tables will restrict external access to the affected EC2 instance. However, it will still be able to communicate within the subnet and continue to spread to other resources within the same subnet.</p>
<h3 id="containing-ec2-using-internet-gateways">Containing EC2 Using Internet Gateways</h3>
<p>EC2 Isolation using internet gateways restricts internet connectivity to the VPCs that host the EC2 instances. However, restricting access using internet gateways are not straightforward since AWS will not allow users to remove the internet gateways if any EC2 dependencies within the VPC require the internet gateway.</p>
<p>Users are required to remove all dependencies to isolate an EC2 instance using an internet gateway successfully. However, this is not feasible during an incident response scenario.</p>
<p>Instead, users may obtain the same effect by removing all the internet gateway routes from the routing table or attaching a custom route table with no rules for all subnets.</p>
<h3 id="ec2-containment-playbook">EC2 Containment Playbook</h3>
<p>A well-balanced and practical incident response playbook must cover all possible aspects when containing an affected resource. It must not restrict itself to a network containment approach but explore all possible methods of limiting access to and from the affected EC2 instance.</p>
<p>The following playbook provides a good starting point for organizations to adopt an EC2 containment playbook that covers most basic containment areas.</p>
<ol>
<li>Tag and detach the EC2 instance from any auto-scaling group</li>
<li>Create a new security group that denies both inbound and outbound traffic (Empty Security Group)</li>
<li>Remove any existing security groups and associate them with the “empty” security group</li>
<li>Remove any IAM roles associated with the instance</li>
<li>Create a snapshot of the root volume</li>
<li>Create an AMI (Amazon Machine Image) of the instance for later analysis</li>
</ol>
<p>It is also important to tag all entities used for isolation so that the same resources will not be used for any other business operation that can render the isolation ineffective.</p>
<h3 id="ec2-contain-with-automation">EC2 contain with automation</h3>
<p>or automate with lambda <a href="https://aws.amazon.com/blogs/security/automate-amazon-ec2-instance-isolation-by-using-tags/">here</a></p>
<p>or check the automation <a href="https://docs.aws.amazon.com/systems-manager-automation-runbooks/latest/userguide/aws-quarantineec2instance.html">here</a></p>
<h2 id="aws-iam">aws iam</h2>
<p>https://aws.amazon.com/blogs/security/what-to-do-if-you-inadvertently-expose-an-aws-access-key/</p>
<h2 id="reference-and-related">reference-and-related</h2>
<p><a href="../infosec-compendiums/">infosec-compendiums</a>
<a href="../aws-protect/">aws-protect</a>
<a href="https://dev.to/aws-builders/aws-incident-response-how-to-contain-an-ec2-instance-pjk">dev.to/aws-builders</a></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../aws-protect/" class="md-footer__link md-footer__link--prev" aria-label="Previous: AWS Protect">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                AWS Protect
              </div>
            </div>
          </a>
        
        
          
          <a href="../aws-security-tips/" class="md-footer__link md-footer__link--next" aria-label="Next: AWS Security Tips">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                AWS Security Tips
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
      
    
    
    
    <a href="https://infosec.exchange/@aldosimon" target="_blank" rel="noopener me" title="ewaldo simon hiras on mastodon" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M433 179.1c0-97.2-63.7-125.7-63.7-125.7-62.5-28.7-228.6-28.4-290.5 0 0 0-63.7 28.5-63.7 125.7 0 115.7-6.6 259.4 105.6 289.1 40.5 10.7 75.3 13 103.3 11.4 50.8-2.8 79.3-18.1 79.3-18.1l-1.7-36.9s-36.3 11.4-77.1 10.1c-40.4-1.4-83-4.4-89.6-54-.6-4.6-.9-9.3-.9-13.9 85.6 20.9 158.7 9.1 178.7 6.7 56.1-6.7 105-41.3 111.2-72.9 9.8-49.8 9-121.5 9-121.5zm-75.1 125.2h-46.6V190.1c0-49.7-64-51.6-64 6.9v62.5H201V197c0-58.5-64-56.6-64-6.9v114.2H90.3c0-122.1-5.2-147.9 18.4-175 25.9-28.9 79.8-30.8 103.8 6.1l11.6 19.5 11.6-19.5c24.1-37.1 78.1-34.8 103.8-6.1 23.7 27.3 18.4 53 18.4 175"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.twitter.com/aldosimon" target="_blank" rel="noopener" title="ewaldo simon hiras on twitter" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
    <a href="https://linkedin.com/in/aldosimon" target="_blank" rel="noopener" title="ewaldo simon hiras on linkedin" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://aldosimon.com" target="_blank" rel="noopener" title="ewaldo simon hiras&#39;s blog" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M35.7 171.1c-46.9 46-46.9 122.9 0 169.8l135.9 135.9c46 46.9 122.9 46.9 169.8 0l135.9-135.9c46.9-46.9 46.9-123.8 0-169.8L341.4 35.2c-46.9-46.9-123.8-46.9-169.8 0zM196 196.5a84.5 84.5 0 1 1 120 119 84.5 84.5 0 1 1-120-119"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/aldosimon" target="_blank" rel="noopener" title="ewaldo simon hiras&#39;s github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.footer"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>